{"componentChunkName":"component---src-templates-article-js","path":"/posts/pip-in-maps/","result":{"data":{"markdownRemark":{"id":"946f5368-9081-5efa-97f1-ca08398688eb","html":"<p>I've always thought of Chinese apps as \"more of an OS than an app,\" but recently realized that I judged based on mostly two apps: Wechat and Alipay. While it's probably unlikely that you see really simple apps like a funny-looking \"random number generator\" on a Chinese phone (they use Wechat mini-programs,) most everyday apps look similar enough to their Silicon Valley counterparts, with a slight twist to accommodate Chinese culture and lifestyle.</p>\n<p>One example would be the <em>Wechat Moment</em> feature in which you can selectively show or hide your post to specific group of friends - it's now available on Facebook as well, but not back in 2015. It wouldn't cost a lot to implement yet would increase users' satisfaction a lot - regardless of cultural backgrounds, most people had gone through hard times when they wanted to vent within their 5 closest friends, wouldn't they? I'm still wondering why it took years for then-Facebook-now-Meta to keep up. Apart from the fact that Zuck wanted to spend the money on Metauniverse, it was possible that Americans are less likely than Asians to <em>admit</em> that they want this feature. The one feature on a Chinese app I used this year is the epitome of \"localized UX design\" that's \"outside the box.\"</p>\n<p>Welcome to Chinese map apps, which shows your route in as a floating window when you \"background\" the app to do something else... <strong>even before the existence of Dynamic Island.</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/68ef8802b71fd9005138dac574619288/78797/tencent-map.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PiP Mode in Tencent Map\"\n        title=\"PiP Mode in Tencent Map\"\n        src=\"/static/68ef8802b71fd9005138dac574619288/d9199/tencent-map.png\"\n        srcset=\"/static/68ef8802b71fd9005138dac574619288/8ff5a/tencent-map.png 240w,\n/static/68ef8802b71fd9005138dac574619288/e85cb/tencent-map.png 480w,\n/static/68ef8802b71fd9005138dac574619288/d9199/tencent-map.png 960w,\n/static/68ef8802b71fd9005138dac574619288/78797/tencent-map.png 1125w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>I've used it in Tencent Maps, and according to my friends in China, it's available on Baidu and Gaode as well. How surprising (pun intended :P)</p>\n<h3>How It's Implemented</h3>\n<p>The first time I used it, I thought it looked similar to the <a href=\"https://developer.apple.com/documentation/avkit/adopting-picture-in-picture-in-a-custom-player\">\"Picture in Picture\" mode,</a> but I looked into the developer docs and couldn't figure out how to do it without an actual video stream, and I thought it would be costly to \"manually\" convert some <code>UIView</code> to a video stream 😂 then I thought maybe it was the <a href=\"https://developer.apple.com/documentation/activitykit/displaying-live-data-with-live-activities\">\"Live Activities,\"</a> but it looked different, and the timeline didn't match - according to the release notes, Tencent Map on iOS starts supporting Live Activities at the end of March, a while later than me seeing this \"floating window\" feature.</p>\n<p>Then I realized that Google Meet on iOS looks like this...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1bbc5da5103e99a7a239198a9a25117/ec605/google-meet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAArABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQCAwUB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgEA/9oADAMBAAIQAxAAAAHNhbMpEkIu9vkHlDQprJaFUzIGv//EABsQAAMBAAMBAAAAAAAAAAAAAAECAwAREiEy/9oACAEBAAEFAuoYNMByNA86k8/KtEIDVudX1lSgDA9HkaG6+AULBEz+N2OX5//EABsRAAIBBQAAAAAAAAAAAAAAAAABERASITFR/9oACAEDAQE/AYVFrBa+Ckln/8QAFxEAAwEAAAAAAAAAAAAAAAAAEBEgQf/aAAgBAgEBPwEao//EACAQAAIBBAIDAQAAAAAAAAAAAAABEQISITEQQQMTQmH/2gAIAQEABj8CS6Ma4VFrcjqghqDx1eyH3+DV/wBG5KMU4HhbkmUhWbFdowY5/8QAHRABAAMAAwADAAAAAAAAAAAAAQARITFBUWGRof/aAAgBAQABPyGms9RsOx3No9Cw9iFiAaqGwF4yx3T6IY2H6+YS0WOVhm08H2HAE0uddiqmEbLBIOtlDBU5WI+nOzYuf//aAAwDAQACAAMAAAAQPwSzeC//xAAbEQEAAgIDAAAAAAAAAAAAAAABABEhMRBhof/aAAgBAwEBPxAoxN6gWw4DBnyd0//EABgRAAMBAQAAAAAAAAAAAAAAAAABESFx/9oACAECAQE/ENTJCyg3us6RH//EACAQAQADAQACAgMBAAAAAAAAAAEAESExQWFRkXGB4fD/2gAIAQEAAT8QAEhReszyhsyX2rWOQw5WeCotZAlYw5PjofFPK+4zKA+SDpTuUO1b7chtbhEL7Lt/uTgSrtMITsEz83+x4gKcNI4B6gUDB0X9/c1Q6tUAV77GRwQ4M1LBsmhFa9vvZRTzWzrNzwyf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Google Meet PiP mode\"\n        title=\"Google Meet PiP mode\"\n        src=\"/static/b1bbc5da5103e99a7a239198a9a25117/6a068/google-meet.jpg\"\n        srcset=\"/static/b1bbc5da5103e99a7a239198a9a25117/09b79/google-meet.jpg 240w,\n/static/b1bbc5da5103e99a7a239198a9a25117/7cc5e/google-meet.jpg 480w,\n/static/b1bbc5da5103e99a7a239198a9a25117/6a068/google-meet.jpg 960w,\n/static/b1bbc5da5103e99a7a239198a9a25117/ec605/google-meet.jpg 1125w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Now that I know it's possible for PiP mode to show something that's probably not a video, a quick search on GitHub showed <a href=\"https://github.com/uakihir0/UIPiPView\">an example (UIPiPView)</a> that did the work within less than 500 lines of code. The gist is that you turn an <code>UIView</code> to a \"video stream\" by the following transformations:</p>\n<p><code>UIView</code> -> <code>CVPixelBuffer</code> -> <code>CMSampleBuffer</code> -> enqueue to <code>AVSampleBufferDisplayLayer</code></p>\n<p>so indeed... it did the \"costly\" work of \"converting <code>UIView</code> into a video stream\" 😂 this is actually a bit harder than I have expected.</p>\n<h3>Why I think it's Brilliant</h3>\n<p>In my opinion, the best products are the ones you don't know you need until you try them. For those taking public transportation, that means reading your news or social media feed in peace, knowing that you won't miss your stop, especially on a bus instead of metro.</p>\n<p>In hindsight, my experiences riding on bus in foreign countries had always included frequent switching between Google Maps and something else to kill time. I probably wouldn't have Google Maps open the entire ride because it would be boring, but I always needed to switch back and see which two stops I was between, and how many more stops to go. Having a \"floating window\" that keeps me updated over my newsfeed or something calms me down during the journey. It's proved to be something that I haven't known that I needed, and now I do.</p>\n<p>I also think that building it through the PiP interface exemplifies \"thinking outside the box,\" since that the interface probably isn't designed as a \"all-purpose floating window\" in the first place. \"Geolocation update\" and \"video playing\" sound so unrelated to each other that it takes a genius mind to connect the dots!</p>\n<h3>Why is it better than Live Activities in Dynamic Island?</h3>\n<ol>\n<li>\"Live Activities\" isn't <em>designed</em> to stay on the screen the entire time. (Techically, it can, so maybe this shouldn't count...)</li>\n<li>Even if it does, you cannot move it around - it only sticks to the top, so unless you dismiss it, the top part of your screen would be hidden.</li>\n</ol>\n<h3>Let's talk about the Cons, of course.</h3>\n<p>I'm pretty sure compiling AVKit and having to convert views to videos real time takes a bunch of memory. Tallying with the most complained issues by my friends in China - their smartphones burn out really fast...</p>\n<h3>Culture and Localization</h3>\n<p>I'm concluding the article with this section because well, it contains a <em>conclusion</em>, and unfortunately, a disappointing one.</p>\n<p>I started asking myself this question - why don't we have the \"floating geolocation update\" in American map apps?</p>\n<p>As a mobile developer who works in the States, I'm trying to convince myself that it was for the following - </p>\n<ol>\n<li>Wayyyy less people take public transportation, especially buses. And then on half of those old metros, your phone doesn't get stable signal so of course you don't get geolocation updates...</li>\n<li>Performance over athetics. Quality over quantity.</li>\n<li>I know for a fact that Bay area tech giants like Google and Apple have much slower release cycle and much stricter legal and privacy review. It's perfectly normal for cool features to be delayed. There's also a chance that some legal issues get in the way.</li>\n</ol>\n<p>But deep down, I think I know the real reason -</p>\n<ol start=\"3\">\n<li>China has better mobile app developers 😂</li>\n</ol>\n<p>You know why. Chinese do everything on their phones. Most internet services - even the big ones like Taobao - don't even come with a reliable desktop interface because well, no one cares. All investment goes to mobile apps since 10+ years ago... there's no way they aren't better trains than us 😭</p>","timeToRead":5,"frontmatter":{"title":"PiP in Maps: The Cultural Twist and Out-of-Box Thinking","date":"July 02, 2024"}}},"pageContext":{"slug":"/posts/pip-in-maps/","prev":null,"next":{"slug":"/posts/tofu-60-v2/","title":"机械键盘果然是个坑"}}},"staticQueryHashes":["320962347","63159454"]}